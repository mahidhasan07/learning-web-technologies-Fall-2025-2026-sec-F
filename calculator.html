<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Simple JS-created Calculator</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body{
      font-family: Arial, Helvetica, sans-serif;
      display:flex;
      justify-content:center;
      align-items:center;
      min-height:100vh;
      background:#f3f4f9;
      margin:0;
    }
    #calculator{
      width:300px;
      background:white;
      padding:16px;
      border-radius:10px;
      box-shadow:0 6px 18px rgba(0, 0, 0, 0.08);
    }
    #display{
      width:100%;
      height:54px;
      font-size:24px;
      text-align:right;
      padding:8px 10px;
      box-sizing:border-box;
      border:1px solid #ddd;
      border-radius:6px;
      margin-bottom:10px;
    }
    #buttons{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
    }
    button{
      width:64px;
      height:48px;
      border-radius:8px;
      border:1px solid #d1d5db;
      background:#fff;
      font-size:18px;
      cursor:pointer;
    }
    button.op{ background:#f8fafc; }
    button.equal{ background:#0ea5a4; color:white; border:none; }
    button.wide{ width:136px; }
  </style>
</head>
<body>
  <div id="calculator">
    <input id="display" type="text" disabled aria-label="calculator display" />
    <div id="buttons"></div>
  </div>

  <script>
    const buttons = [
      "AC", "C", "/", "*",
      "7","8","9","-",
      "4","5","6","+",
      "1","2","3","=",
      "0", "."
    ];

    const ops = ["+", "-", "*", "/"];
    const display = document.getElementById("display");
    const container = document.getElementById("buttons");

    buttons.forEach(label => {
      const btn = document.createElement("button");
      btn.textContent = label;

      if (label === "=") btn.classList.add("equal");
      if (label === "0") btn.classList.add("wide");

      if (ops.includes(label) || label === "C" || label === "AC") btn.classList.add("op");

      btn.addEventListener("click", () => handleButton(label));
      container.appendChild(btn);
    });

    function lastChar(){
      const v = display.value;
      return v.length ? v.charAt(v.length - 1) : "";
    }

    function isOperator(ch){
      return ops.indexOf(ch) !== -1;
    }

    function handleButton(label){
      if (label === "AC"){
        display.value = "";
        return;
      }
      if (label === "C"){
        display.value = display.value.slice(0, -1);
        return;
      }
      if (label === "="){
        const expr = display.value;
        if (!expr) return;
        const last = lastChar();
        if (isOperator(last) || last === ".") return;

        try {
          const result = Function("return " + expr)();
          if (result === Infinity || result === -Infinity || Number.isNaN(result)) {
            display.value = "Error";
          } else {
            display.value = Number.isInteger(result) ? result.toString() : result.toString();
          }
        } catch (e){
          display.value = "Error";
        }
        return;
      }
      if (label === "."){
        const v = display.value;
        let lastOpPos = -1;
        ops.forEach(op => {
          const p = v.lastIndexOf(op);
          if (p > lastOpPos) lastOpPos = p;
        });
        const currentNumber = v.slice(lastOpPos + 1);
        if (currentNumber.indexOf(".") !== -1) return;
        if (currentNumber === "") {
          display.value += "0.";
        } else {
          display.value += ".";
        }
        return;
      }
      if (isOperator(label)){
        const v = display.value;
        const last = lastChar();
        if (!v) {
          if (label === "-") {
            display.value = "-";
          }
          return;
        }
        if (isOperator(last)) {
          display.value = v.slice(0, -1) + label;
          return;
        }
        display.value += label;
        return;
      }
      if (/\d/.test(label)){
        display.value += label;
        return;
      }
    }
  </script>
</body>
</html>
